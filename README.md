# Онлайн магазин
## Запуск
Пока запускается через go run cmd/main.go в каждом модуле.
В корнях модулей, использующих Postgres есть init.sql, создающий таблицы и sample_data.sql с тестовыми данными.
Настроить хосты, порты, названия баз и другое можно через config.yaml

## Сервисы
- Продукты
  * API (REST)
    * GET /api/product/{id}. Получить информацию о продукте
    * GET /api/product?limit=&offset=. Получить список продуктов (постраничный вывод)
    * POST /api/product. Создать продукт
    * PUT /api/product. Обновить информацию о продукте
    * DELETE /api/product/{id}. Удалить продукт
  * Связи
    * Используется Postgres (таблица products)
    * Используется Redis (кэш, хранит доступности продуктов, т.е. есть ли определенный продукт наличии)
    * Соединен с сервисом склада по gRPC (проверяется наличие продукта)
- Заказы
  * API (REST)
    * GET /api/order/{id}. Получить информацию о заказе
    * GET /api/order?user=. Получить все заказы пользователя
    * POST /api/order. Создать заказ
    * DELETE /api/order/{id}. Удалить заказ
  * Связи
    * Используется MongoDB (коллекция orders)
    * Соединен с сервисом склада по gRPC (проверяется наличие продукта)
    * Отправляет сообщения о создания заказа в Kafka
- Склад
  * API (gRPC)
    * CheckAvaliable. Проверить остались ли заданные товары на складе
    * Reserve. Зарезервировать товары. Используются SQL транзакции, чтобы гарантировать достаточное количество всех товаров из списка на складе
    * CancelReserve. Отменить резерв.
  * Связи
    * Используется Postgres (таблица inventory)
- Уведомления
  * Связи
    * Kafka. Читает новые сообщения (созданные после запуска сервиса)
    * Почтовый сервер. Прочитанные сообщения отправляет по электронной почте.
- GraphQL связывает сервис продуктов и заказов в единую схему (4 запроса, 5 мутаций)

